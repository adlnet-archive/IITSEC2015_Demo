{"extends":"box2.vwf","source":"vwf/model/threejs/box.js","type":"subDriver/threejs","sequence":0,"random":{"s0":0.0036750102881342173,"s1":0.3235926926136017,"s2":0.5562430527061224,"c":1815360},"properties":{"___physics_activation_state":1,"___physics_deactivation_time":0,"___physics_velocity_linear":[0,0,0],"___physics_velocity_angular":[0,0,0],"Ammo":1000,"DisplayName":"50CalBase","EditorData":{"accuracy":{"displayname":"accuracy","max":50,"min":2,"property":"accuracy","step":1,"type":"slider"}},"EditorDate":"","_length":0.33,"accuracy":50,"fireSound":"/sas/assets/bdd66107","firecounter":0,"keysDown":[],"lastx":0.0126315789473684,"lasty":0.486051905717151,"materialDef":{"alpha":1,"ambient":{"b":1,"g":1,"r":1},"color":{"a":1,"b":1,"g":1,"r":1},"emit":{"b":0,"g":0,"r":0},"layers":[{"alpha":1,"blendMode":0,"mapInput":0,"mapTo":1,"offsetx":0,"offsety":0,"rot":0,"scalex":1,"scaley":1,"src":"checker.jpg"}],"reflect":0.8,"shadeless":false,"shadow":true,"shininess":15,"specularColor":{"b":0.577350269189626,"g":0.577350269189626,"r":0.577350269189626},"specularLevel":1},"mouseDown":false,"owner":"ADLteam","reloadSound":"/sas/assets/ee04dc80","state":"ready","tracerDef":{"extends":"sphere2.vwf","methods":{"tick":{"body":" // The tick function is called 20 times every second.\n    // Write code here to animate over time\n    this.life++;\n    if(this.life > 20)\n         vwf.deleteNode(this.id); ","parameters":[]}},"properties":{"DisplayName":"sphere1","___physics_activation_state":1,"___physics_deactivation_time":0,"___physics_velocity_angular":[0,0,0],"___physics_velocity_linear":[0,0,0],"isSelectable":false,"life":0,"materialDef":{"alpha":1,"ambient":{"b":1,"g":1,"r":1},"color":{"a":1,"b":1,"g":1,"r":1},"emit":{"b":0,"g":0,"r":0},"layers":[{"alpha":1,"blendMode":0,"mapInput":0,"mapTo":1,"offsetx":0,"offsety":0,"rot":0,"scalex":1,"scaley":1,"src":"checker.jpg"}],"reflect":0.8,"shadeless":false,"shadow":true,"shininess":15,"specularColor":{"b":0.577350269189626,"g":0.577350269189626,"r":0.577350269189626},"specularLevel":1},"owner":"Anonymous_wpez3LO-WphZ6WWjAAAA","radius":0.2,"transform":[1,0,0,0,0,1,0,0,0,0,1,0,-13.75,-0.25,0,1],"type":"Primitive","visible":true},"random":{"c":1,"s0":0.206418882822618,"s1":0.937666497891769,"s2":0.393718022387475},"sequence":0,"source":"vwf/model/threejs/sphere.js","type":"subDriver/threejs"},"transform":[0.5735764503479004,-0.8191520571708679,0,0,0.8191520571708679,0.5735764503479004,0,0,0,0,1,0,0.33858805894851685,-3.330533266067505,0.037444956600666046,1],"type":"Primitive","width":0.33,"sourceAssetId":"06f4f9c2","controllingCamera":"SandboxCamera-vwf-Na423d1"},"methods":{"firing":{"body":"                     return (this.keysDown.indexOf(' ') !== -1)                     ","parameters":[]},"ready":{"body":"                     this.Scene.unbind(\"pointerMove\", this._pv);\n    this.Scene.unbind(\"pointerDown\", this._pd);\n    this.Scene.unbind(\"pointerUp\", this._pu);\n    \n    this.Scene.unbind(\"keyDown\", this._kd);\n    this.Scene.unbind(\"keyUp\", this._ku);\n    var self = this;\n    this._pv = function(e, d)\n    {\n        self._pointerMove(e, d);\n    }\n    this._pd = function(e, d)\n    {\n        self._pointerDown(e, d);\n    }\n    this._pu = function(e, d)\n    {\n        self._pointerUp(e, d);\n    }\n    this._kd = function(e, d)\n    {\n        self._keyDown(e, d);\n    }\n    this._ku = function(e, d)\n    {\n        self._keyUp(e, d);\n    }\n    this.Scene.bind(\"pointerMove\", this._pv);\n    this.Scene.bind(\"pointerDown\", this._pd);\n    this.Scene.bind(\"pointerUp\", this._pu);\n    this.Scene.bind(\"keyDown\", this._kd);\n    this.Scene.bind(\"keyUp\", this._ku);                     ","parameters":[]},"tick":{"body":"             if (this.firing() && this.Ammo > 0 && this.state == \"ready\")\n    {\n        var shake = [this.random() / 10 - .05, this.random() / 10 - .05, this.random() / 10 - .05]\n        this.children_by_name[\"50CalPivot\"].children_by_name[\"Camera1\"].transformAPI.move(shake);\n        shake = [this.random() / 10 - .05, this.random() / 10 - .05, this.random() / 10 - .05]\n        this.children_by_name[\"50CalPivot\"].transformAPI.move(shake);\n        this.firecounter++;\n\n        var sound = vwf.callMethod(this.id, \"getSound\", [this.fireSound]);\n        if (!sound || !sound.playing)\n            this.audioAPI.playSound(this.fireSound, true, 300.0);\n        if (this.firecounter == 2)\n        {\n            this.firecounter = 0;\n            this.fire();\n        }\n        this.Ammo -= 10;\n\n        if (this.Ammo == 0)\n        {\n            this.state = \"reloading\";\n            this.firecounter = 170;\n            this.playSound(this.reloadSound, false, 10);\n        }\n    }\n    else\n    {\n        this.audioAPI.stopSound(this.fireSound);\n    }\n    this.children_by_name[\"50CalPivot\"].children_by_name[\"Camera1\"].children_by_name[\"Label1\"].text = Math.floor(this.Ammo);\n    if (this.state == 'reloading')\n    {\n        this.firecounter--;\n        if (this.firecounter == 0)\n        {\n            this.Ammo = 1000;\n            this.state = 'ready';\n        }\n\n    }\n\n    var pos = this.children_by_name[\"50CalPivot\"].children_by_name[\"Camera1\"].transformAPI.getPosition();\n    var goal = [.5, 0, -2];\n    var move = Vec3.subtract(goal, pos, []);\n\n    this.children_by_name[\"50CalPivot\"].children_by_name[\"Camera1\"].transformAPI.move(move[0] / 2, move[1] / 2, move[2] / 2);\n\n    var pos = this.children_by_name[\"50CalPivot\"].transformAPI.getPosition();\n    var goal = [.0, 0, .75];\n    var move = Vec3.subtract(goal, pos, []);\n\n    this.children_by_name[\"50CalPivot\"].transformAPI.move(move[0] / 2, move[1] / 2, move[2] / 2);             ","parameters":[]},"_keyDown":{"body":"    if (this.Scene.clientAPI.getCameraForClient(vwf.client()).id != this.controllingCamera) return;\n    this.keysDown.push(e.key.char);    ","parameters":["e"]},"_keyUp":{"body":"    if (this.Scene.clientAPI.getCameraForClient(vwf.client()).id != this.controllingCamera) return;\n    if (this.keysDown.indexOf(' ') !== -1)\n        this.keysDown.splice(this.keysDown.indexOf(' '), 1)    ","parameters":["e"]},"_pointerDown":{"body":"    if (this.Scene.clientAPI.getCameraForClient(vwf.client()).id != this.controllingCamera) return;\n    if (e.button == \"left\")\n    {\n        this.lastx = e.position[0];\n        this.lasty = e.position[1];\n        this.mouseDown = true;\n    }\n    if (e.button == \"right\")\n    {\n        this.children_by_name[\"50CalPivot\"].children_by_name[\"Camera1\"].fovGoal = 10;\n    }    ","parameters":["e","d"]},"_pointerMove":{"body":"    if (this.Scene.clientAPI.getCameraForClient(vwf.client()).id != this.controllingCamera) return;\n    if (!this.mouseDown) return;\n    var relx = e.position[0] - this.lastx;\n    var rely = e.position[1] - this.lasty;\n\n    this.lastx = e.position[0];\n    this.lasty = e.position[1];\n    this.transformAPI.rotateZ(-relx * 160);\n    this.children_by_name[\"50CalPivot\"].transformAPI.rotateY(rely * 60);    ","parameters":["e","d"]},"_pointerUp":{"body":"    if (this.Scene.clientAPI.getCameraForClient(vwf.client()).id != this.controllingCamera) return;\n    if (e.button == \"left\")\n    {\n        this.lastx = e.position[0];\n        this.lasty = e.position[1];\n        this.mouseDown = false;\n    }\n    if (e.button == \"right\")\n    {\n        this.children_by_name[\"50CalPivot\"].children_by_name[\"Camera1\"].fovGoal = 60;\n    }    ","parameters":["e","d"]},"fire":{"body":"   var origin = this.children_by_name[\"50CalPivot\"].children_by_name[\"Barrel\"].transformAPI.getWorldPosition();\n    var dir = this.children_by_name[\"50CalPivot\"].children_by_name[\"Barrel\"].transformAPI.localToGlobalRotation([0, 0, 1]);\n    var shake = [this.random() / this.accuracy - 1 / this.accuracy, this.random() / this.accuracy - 1 / this.accuracy, this.random() / this.accuracy - 1 / this.accuracy];\n    dir = Vec3.normalize(Vec3.add(shake, dir, []), []);\n    var hit = this.Scene.traceAPI.rayCast(origin, dir,\n    {\n        ignore: [findviewnode(this.id)]\n    });\n\n    if (hit)\n    {\n        \n        console.log(hit);\n        //  this.tracerDef.properties.transform[12] = hit.point[0];\n        //    this.tracerDef.properties.transform[13] = hit.point[1];\n        //    this.tracerDef.properties.transform[14] = hit.point[2];\n        // this.Scene.children.create(GUID(), this.tracerDef.internal_val);\n        if (hit.node && hit.node.hit)\n            hit.node.hit([hit.point, 5]);\n    }\n    else\n    {\n\n    }   ","parameters":[]}},"children":{"N95451019":{"extends":"box2.vwf","source":"vwf/model/threejs/box.js","type":"subDriver/threejs","sequence":0,"random":{"s0":0.570447616046295,"s1":0.810183898778632,"s2":0.997119625797495,"c":1},"properties":{"___physics_activation_state":1,"___physics_deactivation_time":0,"___physics_velocity_linear":[0,0,0],"___physics_velocity_angular":[0,0,0],"DisplayName":"50CalPivot","_length":0.33,"height":0.39,"materialDef":{"alpha":1,"ambient":{"b":1,"g":1,"r":1},"color":{"a":1,"b":1,"g":1,"r":1},"emit":{"b":0,"g":0,"r":0},"layers":[{"alpha":1,"blendMode":0,"mapInput":0,"mapTo":1,"offsetx":0,"offsety":0,"rot":0,"scalex":1,"scaley":1,"src":"checker.jpg"}],"reflect":0.8,"shadeless":false,"shadow":true,"shininess":15,"specularColor":{"b":0.577350269189626,"g":0.577350269189626,"r":0.577350269189626},"specularLevel":1},"owner":"Anonymous_srrHyERdWKafkXchAAAA","transform":[0.02205572836101055,0,0.9997562170028687,0,0,1,0,0,-0.9997562170028687,0,0.02205572836101055,0,3.0369096748472657e-7,0.0000013282054851515568,0.7500001192092896,1],"type":"Primitive","width":0.33,"___assetServerOriginalID":"N95451019"},"children":{"Nc63b7c4e":{"extends":"SandboxCamera.vwf","source":"vwf/model/threejs/camera.js","type":"subDriver/threejs","sequence":0,"random":{"s0":0.881991325877607,"s1":0.977037542732432,"s2":0.315142978914082,"c":1},"properties":{"DisplayName":"Camera1","fov":60,"fovGoal":60,"owner":"Anonymous_srrHyERdWKafkXchAAAA","transform":[1.2212452212085538e-15,0.9999999403953552,1.9885579405354292e-8,0,9.80333414446477e-9,-1.988558118171113e-8,1,0,1.0000001192092896,-1.0547119792730171e-15,-9.80333503264319e-9,0,0.5000016093254089,0.0000028865931653854204,-2.0000011920928955,1],"___assetServerOriginalID":"Nc63b7c4e"},"methods":{"tick":{"body":"                    // The tick function is called 20 times every second.\n    // Write code here to animate over time\n    this.fov += (this.fovGoal - this.fov) / 5;                    ","parameters":[]}},"children":{"N72a9a368":{"extends":"http://vwf.example.com/label.vwf","sequence":0,"random":{"s0":0.136464140377939,"s1":0.743883366230875,"s2":0.724490934750065,"c":1},"properties":{"DisplayName":"Label1","font_size":68,"height":100,"left":0,"owner":"Anonymous_wS9HWx6DN-wlBP2rAAAG","text":1000,"top":0,"transform":[1,0,0,0,0,1,0,0,0,0,1,0,2.3125,9.48275852203369,0,1],"width":100,"___assetServerOriginalID":"N72a9a368"}}}},"Nf40d8dc8":{"extends":"box2.vwf","source":"vwf/model/threejs/box.js","type":"subDriver/threejs","sequence":0,"random":{"s0":0.809604124864563,"s1":0.25392062519677,"s2":0.65455412468873,"c":1},"properties":{"___physics_activation_state":1,"___physics_deactivation_time":0,"___physics_velocity_linear":[0,0,0],"___physics_velocity_angular":[0,0,0],"DisplayName":"Barrel","_length":0.2,"materialDef":{"alpha":1,"ambient":{"b":1,"g":1,"r":1},"color":{"a":1,"b":1,"g":1,"r":1},"emit":{"b":0,"g":0,"r":0},"layers":[{"alpha":1,"blendMode":0,"mapInput":0,"mapTo":1,"offsetx":0,"offsety":0,"rot":0,"scalex":1,"scaley":1,"src":"checker.jpg"}],"reflect":0.8,"shadeless":false,"shadow":true,"shininess":15,"specularColor":{"b":0.577350269189626,"g":0.577350269189626,"r":0.577350269189626},"specularLevel":1},"owner":"Anonymous_srrHyERdWKafkXchAAAA","transform":[1.0000001192092896,0,-2.2273425326346796e-9,0,0,1,0,0,2.2273425326346796e-9,0,1.0000001192092896,0,7.352501718571602e-9,0,0.7500000596046448,1],"type":"Primitive","width":0.28,"___assetServerOriginalID":"Nf40d8dc8"}}}}}}