{
	"extends": "http://vwf.example.com/node3.vwf",
	"sequence": 0,
	"random": {
		"s0": 0.2935250839218497,
		"s1": 0.8833305018488318,
		"s2": 0.4025755792390555,
		"c": 1
	},
	"properties": {
		"glyphURL": "../vwf/view/editorview/images/icons/sphere.png",
		"transform": [
			1,
			0,
			0,
			0,
			0,
			1,
			0,
			0,
			0,
			0,
			1,
			0,
			-6.193797588348389,
			2.0592727661132812,
			20.009235382080078,
			1
		],
		"owner": "ADLteam",
		"DisplayName": "xAPISender",
		"baseURL": "https://sandbox.adlnet.gov/",
		"EditorData": {
			"baseURL": {
				"displayname": "Base URL",
				"property": "baseURL",
				"type": "text"
			}
		},
		"___sourceAssetTimestamp": "Tue Oct 27 2015 14:41:46 GMT-0400 (Eastern Daylight Time)",
		"sourceAssetId": "6acb0557"
	},
	"methods": {
		"senderSnippet": {
			"body": "/*Generic code for sending xAPI statements from demo*/\n\n    var sender = this.Scene.children_by_name.xAPISender;\n    if (sender)\n    {\n        sender.xAPISend(\"verb\", \"object\", \"role\", null /*context object*/ );\n    }\n\n    /**/",
			"parameters": []
		},
		"xAPISend": {
			"body": "//xAPISend in the xAPISender entity\n    //Sends an xAPI sttement for tracking in an lrs\n    //Accepts:\n    //verbage - verb / action\n    //obj - object\n    //role - role assumed in the simulation\n    //context - items to be appended into contextActviities for greater sortability\n    //Returns:\n    //contructs and sends an xapi statement to an lrs\n\n    console.log(role + \" xAPI Send\");\n\n    //1 - Registration for the run of this game\n    if (!this.Scene.attempt)\n    {\n        this.Scene.attempt = ADL.ruuid();\n    }\n\n    //2 - Wrapper setup\n    var conf = {\n        // \"endpoint\": \"https://lrs.adlnet.gov/xapi/\",\n        \"endpoint\": \"https://40.129.74.197/xapi/\",\n        \"auth\": \"Basic \" + toBase64('iitsecDemo:1234'),\n    };\n    this.Scene.___xAPI.configure(conf);\n\n    //3 - Who is playing\n    var actor = {\n        account:\n        {\n            name: _UserManager.GetCurrentUserName(),\n            homePage: this.baseURL, //\"https://sandbox.adlnet.gov/\",\n        },\n        name: _UserManager.GetCurrentUserName(),\n    };\n\n    //4 - Verb = did\n    var v = encodeURI(verbage);\n    var verb = {\n        id: this.baseURL + \"verbs/\" + v,\n        display:\n        {\n            \"en-US\": v || \"default\",\n        }\n    };\n\n    //5 What happened and where\n    if (typeof obj === 'object')\n    {\n        obj = JSON.stringify(obj);\n    }\n    var object = {\n        id: window.location.toString() + (encodeURI(obj) || \"object\"),\n    };\n\n    //6 - Additional context\n    var contextActivities = {\n        \"grouping\": [\n            {\n                \"id\": this.baseURL + \"ruuid/\" + this.Scene.attempt\n            },\n        ],\n        \"category\": [\n            {\n                \"id\": this.baseURL + \"event/2015/iitsecdemo\"\n            },\n            {\n                \"id\": this.baseURL + \"role/\" + (encodeURI(role) || \"default\")\n            },\n        ],\n        \"other\": [\n            {\n                \"id\": _DataManager.getCurrentApplication(),\n                definition:\n                {\n                    type: this.baseURL + \"world\"\n                }\n            }\n        ],\n    };\n\n    //6.5 - Add any additional keys to Context Activies\n    // let's think this through\n    // we get something or don't in param context\n    // and here we handle that\n    // first we check to see what we've gotten\n    // is it an object  - then\n    console.log('count');\n    if (context)\n    {\n        console.log('context', context);\n        if (typeof context === \"object\")\n        {\n            console.log(\"We found an object\", JSON.stringify(context));\n            for (var a in context)\n            {\n                var str = context[a];\n                console.log(\"object next\", a, str);\n                if (typeof str === 'object')\n                    str = JSON.stringify(str);\n                var temper = {\n                    \"id\": this.baseURL + encodeURI(a) + \"/\" + encodeURI(str),\n                };\n                contextActivities.other.push(temper);\n            }\n        }\n        else //currently if this is a function - i'm in trouble\n        {\n            console.log(\"No object, we are assuming a string or some other simple thing, not a function\");\n            if (typeof context === 'function')\n            { /* Ignore functions */ }\n            else\n            {\n                var temp = {\n                    \"id\": this.baseURL + encodeURI(context)\n                };\n                contextActivities.other.push(temp);\n            }\n        }\n    }\n    console.log('again');\n\n    //7 - Result of the goals\n    var result = {\n        duration: \"PT\" + Math.floor(this.Scene.time) + \"S\"\n    };\n\n    //8 - Roll it all into one statement\n    var stmt = new ADL.XAPIStatement(actor, verb, object);\n    stmt.addParentActivity(new ADL.XAPIStatement.Activity(window.location.toString(), _DataManager.getInstanceData().title, _DataManager.getInstanceData.description, this.Scene.attempt));\n\n    stmt.context.contextActivities = contextActivities;\n    stmt.context.registration = this.Scene.attempt;\n\n    stmt.context.extensions = {\n        \"https://sandbox.adlnet.gov/context/extensions/scene/time/\": this.Scene.time,\n    };\n\n    stmt.result = result;\n    stmt.timestamp = new Date().toISOString();\n\n    this.Scene.___xAPI.sendStatement(null, stmt);",
			"parameters": [
				"verbage",
				"obj",
				"role",
				"context"
			]
		}
	}
}